<html>
  <head>
    <link rel="stylesheet" type="text/css" href="static/css/main.css" />
  </head>
  <body>
<h1>Open ERP logs</h1>
<table class="table table-striped table-bordered table-condensed">
<thead>
    <tr>
        <th class="req_start">Start</th>
        <th class="req">Request</th>
        <th class="res">Response</th>
        <th class="time">Execute Time</th>
    </tr>
</thead>
<tbody id="entries">
</tbody>
</table>

<script type="text/javascript" src="modules.js"></script>
<script type="text/javascript">
    var db = require('db').current();
    var $ = require('jquery');

    db.getView('mulch', 'messages', { descending: 'true' }, function (err, data) {
        if (err) {
            // an error occurred
            return alert(err);
        }
        for (var i = 0; i < data.rows.length; i++) {
            var row = $('<tr>');
            var data_row = data.rows[i].value;
            $('<td class="req_start">').text(data_row.request_start).appendTo(row);
            var col = $('<td class="req">');
            $('<pre>').text(data_row.request.join("\n")).appendTo(col);
            col.appendTo(row);
            col = $('<td class="res">');
            $('<pre>').text(data_row.response.join("\n")).appendTo(col);
            col.appendTo(row);
            $('<td class="time">').text(data_row.response_time).appendTo(row);
            row.appendTo('#entries');
        }
    });
</script>
</body>
</html>

